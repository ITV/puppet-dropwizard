input {
  http_poller {
    type => 'metrics-<%= @name %>'
    codec => 'json'
    interval => 20
    keepalive => false
    request_timeout => 8
    socket_timeout => 5
    urls => {
      metrics => {
        url => "http://localhost:<%= @admin_port %>/metrics"
        method  => get
        headers => {
          Accept => "application/json"
        }
      }
    }
  }
}

# ES 2.x does not support dots in field names
filter {
  if [type] == "metrics-<%= @name %>" {
    de_dot {}
  }
}
